<?xml version="1.0"?><st-source><!-- Name: Seaside-Tests-VisualWorks-AdaptorsNotice: Copyright 1999-2014 Cincom Systems, Inc.  All rights reserved.Application: trueComment: SUnit tests for Seaside Opentalk serverDbIdentifier: bear73DbTrace: 492655DbUsername: jkottDbVersion: 3.2.0 - 1DevelopmentPrerequisites: #(#(#any 'SUnitToo' '') #(#any 'Seaside-VisualWorks-Adaptors' '') #(#any 'Seaside-Welcome' ''))ExplicitPrerequisites: #()IgnoredPrerequisites: #()Namespace: Seaside.SeasideOpentalkTestingPackageName: Seaside-Tests-VisualWorks-AdaptorsParcel: #('Seaside-Tests-VisualWorks-Adaptors')PrerequisiteDescriptions: #(#(#name 'SUnitToo') #(#name 'Seaside-VisualWorks-Adaptors' #componentType #package) #(#name 'Seaside-Welcome' #componentType #package))PrerequisiteParcels: #(#('SUnitToo' '') #('Seaside-VisualWorks-Adaptors' '') #('Seaside-Welcome' ''))PrintStringCache: (3.2.0 - 1,jkott)Version: 3.2.0 - 1Date: 12:17:56 PM September 16, 2016 --><time-stamp>From VisualWorksÂ®, Pre-Release 8.3 (sep16.3) of September 16, 2016 on September 16, 2016 at 12:17:56 PM</time-stamp><do-it>(Dialog confirm: 'You are filing-in a Parcel source file!\\While this is possible it will not have\the same effect as loading the parcel.\None of the Parcel''s prerequisites will\be loaded and none of its load actions\will be performed.\\Are you sure you want to file-in?' withCRs) ifFalse: [self error: 'Parcel file-in abandoned.  Choose terminate or close.']</do-it><class><name>SeasideServerLoggingTest</name><environment>SiouX</environment><super>SUnit.TestCase</super><private>false</private><indexed-type>none</indexed-type><inst-vars>logFileName </inst-vars><class-inst-vars></class-inst-vars><imports></imports><category>SeasideForOpentalkTesting</category><attributes><package>Seaside-Tests-VisualWorks-Adaptors</package></attributes></class><class><name>WAResponseFiledsParsingTest</name><environment>SiouX</environment><super>SUnit.TestCase</super><private>false</private><indexed-type>none</indexed-type><inst-vars></inst-vars><class-inst-vars></class-inst-vars><imports></imports><category>SeasideForOpentalkTesting</category><attributes><package>Seaside-Tests-VisualWorks-Adaptors</package></attributes></class><class><name>SeasideHttpBuildHandlerTest</name><environment>SiouX</environment><super>SUnit.TestCase</super><private>false</private><indexed-type>none</indexed-type><inst-vars></inst-vars><class-inst-vars></class-inst-vars><imports>			private Net.*			</imports><category>SeasideForOpentalkTesting</category><attributes><package>Seaside-Tests-VisualWorks-Adaptors</package></attributes></class><class><name>FormFieldParsingTest</name><environment>SiouX</environment><super>SUnit.TestCase</super><private>false</private><indexed-type>none</indexed-type><inst-vars></inst-vars><class-inst-vars></class-inst-vars><imports>			private Net.*			</imports><category>SeasideForOpentalkTesting</category><attributes><package>Seaside-Tests-VisualWorks-Adaptors</package></attributes></class><class><name>HttpRequestExtTest</name><environment>SiouX</environment><super>SUnit.TestCase</super><private>false</private><indexed-type>none</indexed-type><inst-vars></inst-vars><class-inst-vars></class-inst-vars><imports></imports><category>SeasideForOpentalkTesting</category><attributes><package>Seaside-Tests-VisualWorks-Adaptors</package></attributes></class><class><name>SeasideTransportResource</name><environment>SiouX</environment><super>SUnit.TestResource</super><private>false</private><indexed-type>none</indexed-type><inst-vars></inst-vars><class-inst-vars></class-inst-vars><imports></imports><category>SeasideForOpentalkTesting</category><attributes><package>Seaside-Tests-VisualWorks-Adaptors</package></attributes></class><methods><class-id>SiouX.SeasideServerLoggingTest</class-id> <category>tests</category><body package="Seaside-Tests-VisualWorks-Adaptors">testExternalFileLogging	| response log |	SeasideServer current listeners first connectionPriority: Processor activeProcess priority + 1.	SeasideServer start.	SeasideServer startLog.	[response  := Net.HttpClient get: 'http://localhost:7777/'.	SeasideServer stopLog.	self assert: response notNil.	self assert: response statusLine code = '200'.	log := SeasideServer current log file contentsOfEntireFile.	self assert: log notEmpty.	] ensure: [		SeasideServer stop.		SeasideServer current log file exists ifTrue: [SeasideServer current log file delete]]</body></methods><methods><class-id>SiouX.WAResponseFiledsParsingTest</class-id> <category>tests</category><body package="Seaside-Tests-VisualWorks-Adaptors">newBufferedResponse	^Seaside.WABufferedResponse on: (Grease.GRNullCodec new encoderFor: (String new: 100) readWriteStream)</body><body package="Seaside-Tests-VisualWorks-Adaptors">testParseDate		| response |	response := (self newBufferedResponse			headerAt: 'Content-disposition' put: 'form-data;name=foo';			yourself)			asHttpResponse: Net.HttpResponse new.	self assert: ('HTTP/1.1 200 OK\Content-disposition: form-data;name=foo\\*' withCRs match: response printString)</body><body package="Seaside-Tests-VisualWorks-Adaptors">testParseField		| response |	response := (self newBufferedResponse			headerAt: 'Server' put: 'Seaside server';			yourself)			asHttpResponse: Net.HttpResponse new.	self assert: ('HTTP/1.1 200 OK\Server: Seaside server\\*' withCRs match: response printString)</body></methods><methods><class-id>SiouX.SeasideHttpBuildHandlerTest</class-id> <category>testing</category><body package="Seaside-Tests-VisualWorks-Adaptors">testParsingMultipartFormRequest"Test parsing a multipart upload form request."	| source request fileForm |	source := (self resource wtkUploadFormRequest withEncoding: #iso8859_1) readStream				lineEndCRLF;				yourself.	request := SeasideHttpBuildHandler new				saveAttachmentsAsFiles: false;				readFrom: source.	self assert: request isHttpEntity.	self assert: request contentLength = 1366.	self assert: request isMultipart.	self assert: request parts size = 4.	request parts do: [ :part |		self assert: part isFormData.		self assert: part header fields notEmpty ].	fileForm := request parts at: 3. 	self  assert:  ( fileForm fileName  = 'favicon.ico' ).	self assert: ( fileForm body byteSource isKindOf: ReadWriteStream).</body><body package="Seaside-Tests-VisualWorks-Adaptors">testParsingMultipartFormRequest1"Test parsing a multipart upload form request."	| source request fileForm |	source := (self resource wtkUploadFormRequest withEncoding: #iso8859_1) readStream				lineEndCRLF;				yourself.	request := SeasideHttpBuildHandler readFrom: source.	self assert: request isHttpEntity.	self assert: request contentLength = 1366.	self assert: request isMultipart.	self assert: request parts size = 4.	request parts do: [ :part |		self assert: part isFormData.		self assert: part header fields notEmpty ].	fileForm := request parts at: 3.	self  assert:  ( fileForm fileName  = 'favicon.ico' ).	self assert: ( fileForm body byteSource isExternalStream). 	self assert: ( (fileForm body byteSource fileName components first, '*') match: SeasideHttpBuildHandler defaultAttachmentDirectoryString ).	self assert: ( fileForm body byteSource fileName components last = fileForm fileName ).	request := SeasideHttpBuildHandler readFrom: source reset.	fileForm := request parts at: 3.	self  assert:  ( fileForm fileName  = 'favicon.ico' ).	self assert: ( (fileForm body byteSource fileName components first, '*') match: SeasideHttpBuildHandler defaultAttachmentDirectoryString ).	self assert: ( fileForm body byteSource fileName components last = 'favicon_v1.ico'  ).</body></methods><methods><class-id>SiouX.SeasideHttpBuildHandlerTest</class-id> <category>accessing</category><body package="Seaside-Tests-VisualWorks-Adaptors">resource	^self resources first current</body><body package="Seaside-Tests-VisualWorks-Adaptors">resources	^Array with: SeasideTransportResource</body></methods><methods><class-id>SiouX.FormFieldParsingTest</class-id> <category>testing</category><body package="Seaside-Tests-VisualWorks-Adaptors">testFieldsInStatusLine	| http fields |	http := HttpBuildHandler readFrom: 'GET /seaside/go/tests/alltests?_s=jWLdcNIGRCYYOeTJ&amp;_k=mtJWARRb HTTP/1.1Host: localhost:7777User-agent: Mozilla/5.0 (X11; U; Linux x86_64; en-US; rv:1.8.0.12) Gecko/20070530 Fedora/1.5.0.12-1.fc6 Firefox/1.5.0.12Accept: text/xml,application/xml,application/xhtml+xml,text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5Accept-language: en-us,en;q=0.5Accept-encoding: gzip,deflateAccept-charset: ISO-8859-1,utf-8;q=0.7,*;q=0.7Keep-alive: 300Connection: keep-aliveReferer: http://localhost:7777/seaside/go/tests/alltests?_s=jWLdcNIGRCYYOeTJ&amp;_k=xKqyzClyAuthorization: Basic Y29uZmlnOmNvbmZpZw==' readStream.	fields := (SeasideResponder new requestUrlFor: http) queryFields.	self assert: fields keys size = 2</body></methods><methods><class-id>SiouX.HttpRequestExtTest</class-id> <category>accessing</category><body package="Seaside-Tests-VisualWorks-Adaptors">multipartMessage^'POST /seaside/go/tests/alltests HTTP/1.1Host: localhost:7777Accept: */*Referer: http://localhost:7777/seaside/go/tests/alltests?_s=SuxjosUjTAOMtqpF&amp;_k=dkWRuRfAAccept-language: en-usContent-type: multipart/form-data;boundary=---------------------------7d71dac2a0302Ua-cpu: x86Accept-encoding: gzip,deflateUser-agent: Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 5.1; .NET CLR 1.1.4322; InfoPath.1)Connection: Keep-AliveCache-control: no-cacheContent-length: 1539-----------------------------7d71dac2a0302Content-disposition: form-data;name=44Some Text-----------------------------7d71dac2a0302Content-disposition: form-data;name=45Example Text-----------------------------7d71dac2a0302Content-disposition: form-data;name=46Some Text-----------------------------7d71dac2a0302Content-disposition: form-data;name=47Example Text-----------------------------7d71dac2a0302Content-disposition: form-data;name=4849-----------------------------7d71dac2a0302Content-disposition: form-data;name=5354-----------------------------7d71dac2a0302Content-disposition: form-data;name=59Quito-----------------------------7d71dac2a0302Content-disposition: form-data;name=60-----------------------------7d71dac2a0302Content-disposition: form-data;name=6162-----------------------------7d71dac2a0302Content-disposition: form-data;name=6163-----------------------------7d71dac2a0302Content-disposition: form-data;name=6164-----------------------------7d71dac2a0302Content-disposition: form-data;name=6165-----------------------------7d71dac2a0302Content-disposition: form-data;name=66-----------------------------7d71dac2a0302Content-disposition: form-data;name=6768-----------------------------7d71dac2a0302Content-disposition: form-data;name=_sSuxjosUjTAOMtqpF-----------------------------7d71dac2a0302Content-disposition: form-data;name=_kfUYThgzE-----------------------------7d71dac2a0302--'</body></methods><methods><class-id>SiouX.HttpRequestExtTest</class-id> <category>testing</category><body package="Seaside-Tests-VisualWorks-Adaptors">testAsWARequest		| mess coll fields |	mess := Net.HttpRequest readFrom: self multipartMessage readStream.	fields := SeasideResponder new requestFieldsFor: mess.	self assert: fields size = 16.	coll := fields allAt: '61' ifAbsent: [ self assert: false].	self assert: coll size = 4</body></methods><methods><class-id>SiouX.SeasideTransportResource</class-id> <category>accessing</category><body package="Seaside-Tests-VisualWorks-Adaptors">wtkUploadFormRequest"This one was generated by Firefox talking to WTK upload servlet, see SimpleFileUploadServlet in WWTools.	self new wtkUploadFormRequest asString"	^ByteArray fromHexString: '504F5354202F736572766C65742F53696D706C6546696C6555706C6F6164536572766C657420485454502F312E310D0A486F73743A206C6F63616C686F73743A383030380D0A557365722D4167656E743A204D6F7A696C6C612F352E3020285831313B20553B204C696E7578207838365F36343B20656E2D55533B2072763A312E382E302E3729204765636B6F2F3230303630393133204665646F72612F312E352E302E372D312E6663352046697265666F782F312E352E302E372070616E676F2D746578740D0A4163636570743A20746578742F786D6C2C6170706C69636174696F6E2F786D6C2C6170706C69636174696F6E2F7868746D6C2B786D6C2C746578742F68746D6C3B713D302E392C746578742F706C61696E3B713D302E382C696D6167652F706E672C2A2F2A3B713D302E350D0A4163636570742D4C616E67756167653A20656E2D75732C656E3B713D302E350D0A4163636570742D456E636F64696E673A20677A69702C6465666C6174650D0A4163636570742D436861727365743A2049534F2D383835392D312C7574662D383B713D302E372C2A3B713D302E370D0A4B6565702D416C6976653A203330300D0A436F6E6E656374696F6E3A206B6565702D616C6976650D0A526566657265723A20687474703A2F2F6C6F63616C686F73743A383030382F66696C6575706C6F6164746573742E7373700D0A436F6F6B69653A2056572D57544B2D73657373696F6E6B65793D343738343733333430363039353931333334303632373539313833350D0A436F6E74656E742D547970653A206D756C7469706172742F666F726D2D646174613B20626F756E646172793D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D32303735333734393035343930363035313734343031353338310D0A436F6E74656E742D4C656E6774683A20313336360D0A0D0A2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D32303735333734393035343930363035313734343031353338310D0A436F6E74656E742D446973706F736974696F6E3A20666F726D2D646174613B206E616D653D2266696C654E616D65220D0A0D0A7765622F6578616D706C65732F66617669636F6E2E69636F0D0A2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D32303735333734393035343930363035313734343031353338310D0A436F6E74656E742D446973706F736974696F6E3A20666F726D2D646174613B206E616D653D2272616E646F6D546578744669656C64220D0A0D0A0D0A2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D32303735333734393035343930363035313734343031353338310D0A436F6E74656E742D446973706F736974696F6E3A20666F726D2D646174613B206E616D653D2266696C654265696E6755706C6F61646564223B2066696C656E616D653D2266617669636F6E2E69636F220D0A436F6E74656E742D547970653A20696D6167652F782D69636F0D0A0D0A0000010001002020100000000000E802000016000000280000002000000040000000010004000000000080020000000000000000000000000000000000000000000000008000008000000080800080000000800080008080000080808000C0C0C0000000FF0000FF000000FFFF00FF000000FF00FF00FFFF0000FFFFFF0000000000000000CCCC000000000000000000000000000CCCCCCCC00000000000000000000000CCCCCCCCEECCCC00000000000000000CCCCCCCCEECCCCCCC00000000000000FCCCCCCCCECCCCCCCCC000000000000CFFFFFCCCECCCCCCCCCE00000000000CCCCCFFFFFFCCCCCCCCEE0000000000CCCCCCCCCECFFFCCCCCEEEE00000000CCCCCCCCCECCCCFFFFEEEEEE00000000CCCCCCCCECCCCCCCFFEEEEEE00000000FFFCCCCCECCCCCCCCFFEEEEC00000222FFFFFFCEECCCCCCCEEFEEECCE0002222FFFFFFEECCCCCCCEEEFEECCEE00222222FFFFFEEFFFFCCEEEEFFCCEEEE2222222FFFFFEEFFFFFFEEEEFFCEEEEEF222222AFFFFEEFFFFFFEEEECFEEEEEEFFF2222AAAAAAEFFFFFFEEECCFEEEEEE0FFFFFAAEAAAAAAFFFFFEECCEFFEEEEE0FFFFFFAEEEEEAACCCCFECCEEEFEEEE00FFFFFFAEEEEECACCCCCCCEEEEFFEE0000FFFFFAEEEECCAFFFFCCEEEEEFFE000002FFFFAEEECCCCAFFFFFEEEEEFF000000222222ACCCCCCAFFFFFEEEEEE0000000FF2222AACCCCCAFFFFFEEEEE000000000FFFFAAA222CC22FFFFEEEE0000000000FFFFFAAF222222AAFFEEE00000000000FFFFFAAFFFFF2AAAAA0E000000000000FFFFFFAFFFFFFAAAAA000000000000000FFFFFAAFFFFFAAAAA000000000000000000FFAAFFFFFAAAA00000000000000000000000FFFFFAAA000000000000000000000000000FFAA00000000000000FFFC3FFFFFF807FFFFF0003FFFE0000FFFC00007FF800007FF000007FE000003FC000003FC000003FC000003E0000001C000000180000000000000000000000000000000800000008000000180000003C0000007C000000FC000001FC000003FE000007FE00000FFE00005FFE00007FFF00007FFFE000FFFFFE01FFFFFFC3FFF0D0A2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D32303735333734393035343930363035313734343031353338310D0A436F6E74656E742D446973706F736974696F6E3A20666F726D2D646174613B206E616D653D225375626D6974220D0A0D0A5375626D69742051756572790D0A2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D2D32303735333734393035343930363035313734343031353338312D2D0D0A'</body></methods><methods><class-id>SiouX.SeasideTransportResource</class-id> <category>Running</category><body package="Seaside-Tests-VisualWorks-Adaptors">setUp	| dir |	(dir := SeasideHttpBuildHandler  defaultAttachmentDirectory asFilename) directoryContents		do: [ :fx | (dir construct: fx ) delete ].</body><body package="Seaside-Tests-VisualWorks-Adaptors">tearDown	| dir |	(dir := SeasideHttpBuildHandler  defaultAttachmentDirectory asFilename) directoryContents		do: [ :fx | (dir construct: fx ) delete ].</body></methods><do-it>"Imported Classes:"</do-it><do-it>self error: 'Attempting to file-in parcel imports.  Choose terminate or close'</do-it><class><name>TestResource</name><environment>SUnit</environment><super>Core.Object</super><private>false</private><indexed-type>none</indexed-type><inst-vars></inst-vars><class-inst-vars>current </class-inst-vars><imports></imports><category>SUnit</category><attributes><package>SUnitToo</package></attributes></class><class><name>TestCase</name><environment>SUnit</environment><super>Core.Object</super><private>false</private><indexed-type>none</indexed-type><inst-vars>testSelector </inst-vars><class-inst-vars></class-inst-vars><imports></imports><category>SUnit</category><attributes><package>SUnitToo</package></attributes></class></st-source>