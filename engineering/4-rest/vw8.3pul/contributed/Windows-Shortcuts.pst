<?xml version="1.0"?><st-source><!-- Name: Windows-ShortcutsNotice:  Copyright © 2009-2002 Cincom Systems, Inc.  All Rights Reserved.Comment: These classes allow creation of Windows shortcuts from VisualWorks.  They use COM Connect.(Prerequisites:  a false match of #invokeMethod: to StoreBase has been disregarded.)DbIdentifier: bear73DbTrace: 210213DevelopmentPrerequisites: #(#(#any 'Com- Automation' ''))DisregardedPrerequisites: #(#(#name 'StoreBase' #componentType #bundle))PackageName: Windows-ShortcutsParcel: #('Windows-Shortcuts')ParcelName: Windows-ShortcutsPrerequisiteDescriptions: #(#(#name 'Com- Automation'))PrerequisiteParcels: #(#('Com- Automation' ''))PrintStringCache: (7.7 - 4,smichael)Version: 7.7 - 4Date: 6:30:09 AM August 5, 2009 --><time-stamp>From VisualWorks®, Pre-Release 7.7 (aug09.0) of August 5, 2009 on August 5, 2009 at 6:30:09 AM </time-stamp><do-it>(Dialog confirm: 'You are filing-in a Parcel source file!\\While this is possible it will not have\the same effect as loading the parcel.\None of the Parcel''s prerequisites will\be loaded and none of its load actions\will be performed.\\Are you sure you want to file-in?' withCRs) ifFalse: [self error: 'Parcel file-in abandoned.  Choose terminate or close.']</do-it><class><name>ShortcutError</name><environment>OS</environment><super>Core.Error</super><private>false</private><indexed-type>none</indexed-type><inst-vars></inst-vars><class-inst-vars></class-inst-vars><imports></imports><category>Windows Shortcuts</category><attributes><package>Windows-Shortcuts</package></attributes></class><comment><class-id>OS.ShortcutError</class-id><body></body></comment><class><name>ShortcutValidator</name><environment>OS</environment><super>Core.Object</super><private>false</private><indexed-type>none</indexed-type><inst-vars>shortcut </inst-vars><class-inst-vars></class-inst-vars><imports></imports><category>Windows Shortcuts</category><attributes><package>Windows-Shortcuts</package></attributes></class><comment><class-id>OS.ShortcutValidator</class-id><body></body></comment><class><name>Shortcut</name><environment>OS</environment><super>Core.Object</super><private>false</private><indexed-type>none</indexed-type><inst-vars>location arguments description path workingDirectory </inst-vars><class-inst-vars></class-inst-vars><imports></imports><category>Windows Shortcuts</category><attributes><package>Windows-Shortcuts</package></attributes></class><comment><class-id>OS.Shortcut</class-id><body>Shortcut represents the shortcut construct one might find on any of the Windows operating systems.  In concert with the WScript.Shell COM interface it allows clients to create, delete, modify and view filename that is a shortcut.  See the class side method protocol called examples for examples, along with the instance side opertations protocol for manipulating shortcuts.Instance Variables	location	&lt;String&gt;  The location of the shortcut.	arguments	&lt;String&gt;  The program arguments for the shortcut.	description	&lt;String&gt;  A description for the shortcut.	path	&lt;String&gt;  The target for the shortcut	workingDirectory	&lt;String&gt;  The "Start in" directory for the shortcut.</body></comment><methods><class-id>OS.ShortcutError class</class-id> <category>testing</category><body package="Windows-Shortcuts" selector="mayResume">mayResume	^true</body></methods><methods><class-id>OS.ShortcutValidator class</class-id> <category>operations</category><body package="Windows-Shortcuts" selector="validateForReification:">validateForReification: aShortcut	aShortcut location asFilename canBeWritten ifFalse: [^false].	^true</body><body package="Windows-Shortcuts" selector="validateForResolution:">validateForResolution: aShortcut	^aShortcut location asFilename exists</body></methods><methods><class-id>OS.Shortcut</class-id> <category>accessing</category><body package="Windows-Shortcuts" selector="arguments">arguments	^arguments</body><body package="Windows-Shortcuts" selector="arguments:">arguments: aString		"String including zero or more arguments to pass to the program.  Filename arguments with embedded blanks should be surrounded by double quotes"	arguments := aString</body><body package="Windows-Shortcuts" selector="description">description	^description</body><body package="Windows-Shortcuts" selector="description:">description: aValue	description := aValue</body><body package="Windows-Shortcuts" selector="location">location	^location</body><body package="Windows-Shortcuts" selector="location:">location: aValue	location := aValue</body><body package="Windows-Shortcuts" selector="path">path	^path</body><body package="Windows-Shortcuts" selector="path:">path: aValue	path := aValue</body><body package="Windows-Shortcuts" selector="workingDirectory">workingDirectory	^workingDirectory</body><body package="Windows-Shortcuts" selector="workingDirectory:">workingDirectory: aValue	workingDirectory := aValue</body></methods><methods><class-id>OS.Shortcut</class-id> <category>converting</category><body package="Windows-Shortcuts" selector="asFilename">asFilename	"Return the location as a filename"	^location asFilename</body></methods><methods><class-id>OS.Shortcut</class-id> <category>operations</category><body package="Windows-Shortcuts" selector="modify">modify		"Modify the receiver's real life counterpart to be in sync with the receiver."</body><body package="Windows-Shortcuts" selector="reify">reify	"Make the receiver a real life shortcut."	| shell shortcutDriver |	(ShortcutValidator validateForReification: self) ifFalse: [ShortcutError raise].	shell := COMDispatchDriver createObject: 'WScript.Shell'.	"real := shell CreateShortcut: self location. - seems like it ought to work, but doesn't, so use invokeMethod:"	shortcutDriver := shell invokeMethod: #CreateShortcut with: self location.	shortcutDriver setProperty: #TargetPath value: self path.	shortcutDriver setProperty: #Description value: self description.	shortcutDriver setProperty: #Arguments value: self arguments.	shortcutDriver setProperty: #WorkingDirectory value: self workingDirectory.	shortcutDriver invokeMethod: #Save.	shortcutDriver release.	shell release.</body><body package="Windows-Shortcuts" selector="remove">remove	"Remove the receiver's real life counterpart to be in sync with the receiver."	| linkFilename |	self exists ifFalse: [^self].	(linkFilename := self location asFilename) canBeWritten ifTrue: [linkFilename delete]</body><body package="Windows-Shortcuts" selector="resolve">resolve	"Location should already be set to a filename for a real life shortcut. 	 Populate the receiver with information based on the receiver."	self notYetImplemented</body></methods><methods><class-id>OS.Shortcut</class-id> <category>testing</category><body package="Windows-Shortcuts" selector="exists">exists	location isNil ifTrue: [^false].	^location asFilename definitelyExists</body></methods><methods><class-id>OS.Shortcut</class-id> <category>printing</category><body package="Windows-Shortcuts" selector="printOn:">printOn: aStream 	super printOn: aStream.	aStream nextPut: Character space.	path printOn: aStream.	aStream nextPut: Character space.	arguments printOn: aStream.</body></methods><methods><class-id>OS.Shortcut class</class-id> <category>examples</category><body package="Windows-Shortcuts" selector="sample1">sample1	"self sample1"	| aShortcut |	aShortcut := self new.	^aShortcut		location: 'e:\visualworks\vw30\image\MyShortcut.lnk';		path: 'e:\visualworks\vw30a\bin\visual.exe';		arguments: 'e:\visualworks\vw30\image\visual.im';		description: 'VisualWorks 3.0';		workingDirectory: 'e:\visualworks\vw30\image\';		yourself</body><body package="Windows-Shortcuts" selector="sample2">sample2	"self sample2"	| aShortcut |	aShortcut := self new.	^aShortcut		location: 'c:\MyShortcut.lnk';		path: 'c:\program files\cincom\vw7.7apr091\bin\win\visual.exe';		arguments: '"c:\program files\cincom\vw7.7apr091\image\visual.im"';		description: 'VisualWorks 7.7';		workingDirectory: 'c:\program files\cincom\vw7.7apr091';		yourself</body></methods><methods><class-id>OS.Shortcut class</class-id> <category>instance creation</category><body package="Windows-Shortcuts" selector="fromFilename:">fromFilename: aFilename 	| aShortcut |	aShortcut := self new.	aShortcut location: aFilename.	^aShortcut resolve</body></methods><methods><class-id>OS.Filename</class-id> <category>converting</category><body package="Windows-Shortcuts" selector="asShortcut">asShortcut	self shouldNotImplement</body></methods><methods><class-id>OS.PCFilename</class-id> <category>converting</category><body package="Windows-Shortcuts" selector="asShortcut">asShortcut	^Shortcut fromFilename: self asString</body></methods><do-it>"Imported Classes:"</do-it><do-it>self error: 'Attempting to file-in parcel imports.  Choose terminate or close'</do-it><class><name>Object</name><environment>Core</environment><super></super><private>false</private><indexed-type>none</indexed-type><inst-vars></inst-vars><class-inst-vars></class-inst-vars><imports></imports><category>Kernel-Objects</category><attributes><package>Kernel-Objects</package></attributes></class><class><name>Filename</name><environment>OS</environment><super>Core.Object</super><private>false</private><indexed-type>none</indexed-type><inst-vars>osName publicName logicalName </inst-vars><class-inst-vars></class-inst-vars><imports></imports><category>OS-Support</category><attributes><package>OS-Support</package></attributes></class><class><name>PCFilename</name><environment>OS</environment><super>OS.Filename</super><private>false</private><indexed-type>none</indexed-type><inst-vars></inst-vars><class-inst-vars></class-inst-vars><imports></imports><category>OS-PC</category><attributes><package>OS-PC</package></attributes></class><class><name>Error</name><environment>Core</environment><super>Core.Exception</super><private>false</private><indexed-type>none</indexed-type><inst-vars></inst-vars><class-inst-vars></class-inst-vars><imports></imports><category>Kernel-Exception Handling</category><attributes><package>Kernel-Exception Handling</package></attributes></class></st-source>