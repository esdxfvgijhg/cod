
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">

<HTML>


<!-- Mirrored from www.itl.nist.gov/div898/handbook/pmc/section5/pmc552.htm by HTTrack Website Copier/3.x [XR&CO'2014], Fri, 17 Feb 2017 22:22:06 GMT -->
<HEAD>
<script async type="text/javascript"
        id="_fed_an_ua_tag"
        src="https://dap.digitalgov.gov/Universal-Federated-Analytics-Min.js?agency=DOC&amp;subagency=NIST&amp;pua=UA-37115410-50&amp;yt=true&amp;exts=ppsx,pps,f90,sch,rtf,wrl,txz,m1v,xlsm,msi,xsd,f,tif,eps,mpg,xml,pl,xlt,c">
</script>
<script type="text/javascript"
            src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=default.js">
</script>
<META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=iso-8859-1">
<META NAME="GENERATOR" CONTENT="Mozilla/4.05 [en] (WinNT; U) [Netscape]">
<TITLE>6.5.5.2. Numerical Example</TITLE>
</HEAD>

<BODY BGCOLOR="FFFFCC">

<IMG SRC="../../gifs/nvgtbr.gif" BORDER=0 VALIGN="TOP" ISMAP USEMAP="#MenuBar">
<map name="MenuBar">
<area shape="rect" alt="Next Page" href="../section6/pmc6.html" coords="463,27,504,45">
<area shape="rect" alt="Previous Page" href="pmc551.html" coords="417,28,459,45">
<area shape="rect" alt="Home" href="../../index-2.html" coords="52,0,100,43">
<area shape="rect" alt="Tools & Aids" href="../../toolaids.html" coords="165,27,264,46">
<area shape="rect" alt="Search Handbook" href="../../search.html" coords="307,28,366,44">
<area shape="default" nohref>
</map>
<BR>

<TABLE CELLSPACING=20 CELLPADDING=0 WIDTH=540>

<TR>
<TD VALIGN=TOP COLSPAN=2>
<FONT SIZE=-1>
<FONT COLOR="#D60021">6.</FONT>
<FONT COLOR="#00105A"><A HREF="../pmc.html">Process or Product Monitoring and Control</a></FONT>
<BR>
<FONT COLOR="#D60021">6.5.</FONT>
<FONT COLOR="#00105A"><A HREF="pmc5.html">Tutorials</a></FONT>
<BR>
<FONT COLOR="#D60021">6.5.5.</FONT>
<FONT COLOR="#00105A"><A HREF="pmc55.html">Principal Components</a></FONT>
<BR>
</FONT>
<BR>
<TABLE>
<TR>
<TD VALIGN=top>
<H2><FONT COLOR="#D60021">6.5.5.2.</FONT></H2>
</TD>
<TD VALIGN=top>
<H2>Numerical Example</H2>
</TD>
</TR >
</TABLE>
</TD>
</TR>







<!-- begin paragraph -->
<TR>
<TD WIDTH=15% VALIGN=top>
<!-- Add marginal notes below -->
<i>Calculation of principal components example</i>
</TD>
<TD VALIGN=TOP WIDTH=85%>
<!-- Add main text below -->
<b>A numerical example</b> may clarify the mechanics of principal
component analysis.

</TD>
</TR>
<!-- end paragraph -->

<!-- begin paragraph -->
<TR>
<TD WIDTH=15% VALIGN=top>
<!-- Add marginal notes below -->
<I>
Sample data set
</I>
</TD>
<TD VALIGN=TOP WIDTH=85%>
<!-- Add main text below -->
Let us analyze the following 3-variate dataset with 10 observations.
Each observation consists of 3 measurements on a wafer: thickness,
horizontal displacement, and vertical displacement.


$$ {\bf X} = \left[ \begin{array}{ccc} 
7 & 4 & 3 \\
4 & 1 & 8 \\ 
6 & 3 & 5 \\
8 & 6 & 1 \\
8 & 5 & 7 \\
7 & 2 & 9 \\
5 & 3 & 3 \\
9 & 5 & 8 \\
7 & 4 & 5 \\
8 & 2 & 2  
\end{array} \right] $$

<!--
<center>
<img SRC="eqns/princx1.gif" height=289 width=106 ALT=
"[7  4  3; 4  1  8; 6  3  5; 8  6  1; 8  5  7; 7  2  9;
 5  3  3; 9  5  8; 7  4  5; 8  2  2]">
</center>
-->
</TD>
</TR>
<!-- end paragraph -->

<!-- begin paragraph -->
<TR>
<TD WIDTH=15% VALIGN=top>
<!-- Add marginal notes below -->
<I>
Compute the correlation matrix
</I>
</TD>
<TD VALIGN=TOP WIDTH=85%>
<!-- Add main text below -->
First compute the correlation matrix.


$$ {\bf R} = \left[ \begin{array}{rrr} 
1.00 & 0.67 & -0.10 \\
0.67 & 1.00 & -0.29 \\ 
-0.10 & -0.29 & 1.00 
\end{array} \right] $$

<!--
<center>
<img SRC="eqns/princx2.gif" height=118 width=169 ALT=
"[1.00  .67  -.10; .67  1.00  -.29; -.10  -.29  1.00]">
</center>
-->
</TD>
</TR>
<!-- end paragraph -->

<!-- begin paragraph -->
<TR>
<TD WIDTH=15% VALIGN=top>
<!-- Add marginal notes below -->
<I>
Solve for the roots of \({\bf R}\)
<!-- <b><i>R</i></b> -->
</I>
</TD>
<TD VALIGN=TOP WIDTH=85%>
<!-- Add main text below -->
Next solve for the roots of \({\bf R}\)
<!-- <b>R,</b> -->
using software.
<p>
<center>
<table>
<tr>
   <th valign=top align=center>
      \(\lambda\)
      <!-- <img align=bottom src="eqns/lambda.gif" alt="lambda"> -->
   </th>
   <th valign=top align=center>
      value
   </th>
   <th valign=top align=center>
      proportion
   </th>
</tr>
<tr>
   <td colspan=3>
      <hr noshade>
   </td>
</tr>
<tr>
   <td valign=top align=center>
      1
   </td>
   <td valign=top align=center>
      1.769
   </td>
   <td valign=top align=center>
      0.590
   </td>
</tr>
<tr>
   <td valign=top align=center>
      2
   </td>
   <td valign=top align=center>
      0.927
   </td>
   <td valign=top align=center>
      0.899
   </td>
</tr>
<tr>
   <td valign=top align=center>
      3
   </td>
   <td valign=top align=center>
      0.304
   </td>
   <td valign=top align=center>
      1.000
   </td>
</tr>
</table>
<!-- <img SRC="eqns/princx3.gif" height=140 width=149> -->
</center>
Notice that:
<ul>
   <li>Each eigenvalue satisfies \(|{\bf R} - \lambda {\bf I}| = 0\).
       <!-- |<b>R</b>-<img align=bottom src="eqns/lambda.gif" alt="lambda">
       <b>I|</b> = 0. -->
   <li>The sum of the eigenvalues \(= 3 = p\),
       <!-- <i>p</i>, -->
       which is equal to the trace of \({\bf R}\)
       <!-- <b>R</b> -->
       (i.e., the sum of the main diagonal elements).
   <li>The determinant of \({\bf R}\)
       <!-- <b>R</b> -->
       is the product of the eigenvalues.
   <li>The product is \(\lambda_1 \times \lambda_2 \times \lambda_3 = 0.499\).
       <!-- <img align=absmiddle src="eqns/lambda.gif" alt="lambda">
       <sub>1</sub> x 
       <img align=absmiddle src="eqns/lambda.gif" alt="lambda">
       <sub>2</sub> x 
       <img align=absmiddle src="eqns/lambda.gif" alt="lambda">
       <sub>3</sub> = .499. -->
</ul>

</TD>
</TR>
<!-- end paragraph -->

<tr>
<td VALIGN=TOP WIDTH="15%"><!-- Add marginal notes below -->
<I>
Compute the first column of the \({\bf V}\)
<!-- <b><i>V</i></b> -->
matrix
</I>
</td>

<td VALIGN=TOP WIDTH="85%"><!-- Add main text below -->
Substituting the first eigenvalue of 1.769 and \({\bf R}\)
<!-- <b>R</b> -->
in the appropriate equation we obtain

$$ \left[ \begin{array}{rrr} 
-0.769 & 0.670 & -0.100 \\
0.670 & -0.769 & -0.290 \\ 
-0.100 & -0.290 & -0.769 
\end{array} \right] 
\left[ \begin{array}{c} 
v_{11} \\ v_{21} \\ v_{31} 
\end{array} \right] 
=
\left[ \begin{array}{c} 
0 \\ 0 \\ 0 
\end{array} \right]  \, . $$

<!--
<center>
<img SRC="eqns/princx4.gif" height=118 width=248 ALT=
"[-.769  .67  -.10; .67  -.769  -.29; -.10  -.29  -.769]*
[v(11)  v(21)  v(31)] = [0  0  0]">
</center>
-->
This is the matrix expression for three homogeneous equations with three
unknowns and yields the first column of \({\bf V}\): &nbsp; 
<!-- <b>V:</b> -->
0.64&nbsp; 0.69&nbsp; -0.34&nbsp;
(again, a computerized solution is indispensable).
</td>
</tr>

<!-- begin paragraph -->
<TR>
<TD WIDTH=15% VALIGN=top>
<!-- Add marginal notes below -->
<I>
Compute the remaining columns of the \({\bf V}\)
<!-- <b><i>V</i></b> -->
matrix
</I>
</TD>
<TD VALIGN=TOP WIDTH=85%>
<!-- Add main text below -->
Repeating this procedure for the other two eigenvalues yields the matrix \({\bf V}\).
<!-- <b>V</b> -->

$$ {\bf V} = 
\left[ \begin{array}{rrr} 
0.64  & 0.38 & -0.66 \\
0.69  & 0.10 & 0.72 \\ 
-0.34 & 0.91 & 0.20 
\end{array} \right] $$

<!--
<center>
<img SRC="eqns/princx5.gif" height=118 width=160
ALT="V = [.64  .38  -.66; .69  .10  .72; -.34  .91  .20]">
</center>
-->
Notice that if you multiply \({\bf V}\)
<!-- <b>V</b> -->
by its transpose, the result is an identity matrix, \({\bf V}'{\bf V} = {\bf I}\).
<!-- <b>V'V=I</b>. -->

</TD>
</TR>
<!-- end paragraph -->

<!-- begin paragraph -->
<TR>
<TD WIDTH=15% VALIGN=top>
<!-- Add marginal notes below -->
<I>
Compute the \({\bf L}^{1/2}\)
<!-- <b><i>L</i></b><sup>1/2</sup> -->
matrix
</I>
</TD>
<TD VALIGN=TOP WIDTH=85%>
<!-- Add main text below -->
Now form the matrix \({\bf L}^{1/2}\),
<!-- <b>L</b><sup>1/2</sup>, -->
which is a diagonal matrix whose elements are the 
square roots of the eigenvalues of \({\bf R}\).
<!-- <b>R</b>. -->
Then obtain \({\bf S}\),
<!-- <b>S</b>, -->
the factor structure, using \({\bf S} = {\bf VL}^{1/2}\).
<!-- <b>S</b> = <b>V L<sup>1/2</sup></b> -->

$$ \left[ \begin{array}{rrr} 
0.64  & 0.38 & -0.66 \\
0.69  & 0.10 & 0.72 \\ 
-0.34 & 0.91 & 0.20 
\end{array} \right] 
\left[ \begin{array}{ccc} 
1.33  & 0    & 0 \\
0     & 0.96 & 0 \\ 
0     & 0    & 0.55 
\end{array} \right] 
=
\left[ \begin{array}{rrr} 
0.85  & 0.37 & -0.37 \\
0.91  & 0.10 & 0.40 \\ 
-0.45 & 0.88 & 0.11 
\end{array} \right] $$

<!--
<center>
<img SRC="eqns/princx6.gif" height=118 width=394 ALT=
"[.64  .38  -.66; .69  .10  .72; -.34  .91  .20]*
[1.33  0  0; 0  .96  0; 0  0  .55] =
 [.85  .37  -.37; .91  .10  .40; -.45  .88  .11]">
</center>
-->
So, for example, 0.91 is the correlation between the second variable and the
first principal component.

</TD>
</TR>
<!-- end paragraph -->

<!-- begin paragraph -->
<TR>
<TD WIDTH=15% VALIGN=top>
<!-- Add marginal notes below -->
<I>
Compute the communality
</I>
</TD>
<TD VALIGN=TOP WIDTH=85%>
<!-- Add main text below -->
Next compute the communality, using the first two eigenvalues only.


$$ {\bf SS}' =
\left[ \begin{array}{rr} 
0.85  & 0.37 \\
0.91  & 0.09 \\ 
-0.45 & 0.88  
\end{array} \right] 
\left[ \begin{array}{rrr} 
0.85  & 0.91 & -0.45 \\
0.37  & 0.09 & 0.88 
\end{array} \right] 
=
\left[ \begin{array}{rrr} 
0.8662    & 0.8140  & -0.0606 \\
0.8140    & 0.8420  & -0.3321 \\ 
-0.0606 & -0.3321 & 0.9876 
\end{array} \right] 
$$

<!--
<p>
<img SRC="eqns/princx7.gif" height=118 width=474 ALT="S*S' =
 [.85  .37; .91  .09; -.45  .88]*[.85  .91  -.45; .37  .09  .88] =
 [.8662  .8140  -.0606; .8140  .8420  -.3321; -.0606  -.3321  .9876]">
-->
</TD>
</TR>
<!-- end paragraph -->

<!-- begin paragraph -->
<TR>
<TD WIDTH=15% VALIGN=top>
<!-- Add marginal notes below -->
<I>
Diagonal elements report how much of the variability is explained
</I>
</TD>
<TD VALIGN=TOP WIDTH=85%>
<!-- Add main text below -->
Communality consists of the diagonal elements.
<p>
<center>
<table>
<tr>
   <th valign=top align=center>
      var
   </th>
   <th valign=top align=center>
      &nbsp;
   </th>
</tr>
<tr>
   <td valign=top align=center>
      1
   </td>
   <td valign=top align=center>
      0.8662
   </td>
</tr>
<tr>
   <td valign=top align=center>
      2
   </td>
   <td valign=top align=center>
      0.8420
   </td>
</tr>
<tr>
   <td valign=top align=center>
      3
   </td>
   <td valign=top align=center>
      0.9876
   </td>
</tr>
</table>
</center>
<p>
This means that the first two principal components "explain" 86.62 %
of the first variable, 84.20 % of the second variable, and 98.76 % of
the third.

</TD>
</TR>
<!-- end paragraph -->

<!-- begin paragraph -->
<TR>
<TD WIDTH=15% VALIGN=top>
<!-- Add marginal notes below -->
<I>
Compute the coefficient matrix
</I>
</TD>
<TD VALIGN=TOP WIDTH=85%>
<!-- Add main text below -->
The coefficient matrix, \({\bf B}\),
<!-- <b>B</b>, -->
is formed using the reciprocals of
the diagonals of \({\bf L}^{1/2}\).
<!-- <b>L</b><sup>1/2</sup> -->

$$ {\bf B} = {\bf VL}^{-1/2} =
\left[ \begin{array}{rrr} 
0.48  & 0.40 & -1.20 \\
0.52  & 0.10 & 1.31 \\
-0.26 & 0.95 & 0.37 
\end{array} \right] $$

<p>
<center>
<!-- There was an error in the table below, redid the equation
<img SRC="eqns/princx8.gif" height=118 width=216
ALT="B = V*L**(-1/2) = [.48  .40  -.18; .52  .10  1.31;
 -.26  .95  .37]">
 -->
<!--
B = VL<sup>-1/2</sup> = <img align=middle SRC="eqns/princx8.gif"
    ALT="[.48  .40  -1.20; .52  .10  1.31; -.26  .95  .37]">
-->
</center>
</TD>
</TR>
<!-- end paragraph -->

<!-- begin paragraph -->
<TR>
<TD WIDTH=15% VALIGN=top>
<!-- Add marginal notes below -->
<I>
Compute the principal factors
</I>
</TD>
<TD VALIGN=TOP WIDTH=85%>
<!-- Add main text below -->
Finally, we can compute the factor scores from \({\bf ZB}\),
<!-- <b>ZB</b>, -->
where \({\bf Z}\) is \({\bf X}\)
<!-- <b>Z</b> is <b>X</b> -->
converted to standard score form.  These
columns are the <i>principal factors</i>.

$$ {\bf F} = {\bf ZB} = 
\left[ \begin{array}{rrr} 
0.41  & -0.69 & 0.06 \\
-2.11 & 0.07 & 0.63 \\
-0.46 & -0.32 & 0.30 \\
1.62 & -1.00 & 0.70 \\
0.70 & 1.09 & 0.65 \\
-0.86 & 1.32 & -0.85 \\
-0.60 & -1.31 & 0.86 \\
0.94 & 1.72 & -0.04 \\
0.22 & 0.03 & 0.34 \\
0.15 & -0.91 & -2.65 
\end{array} \right] $$

<!--
<center>
<img SRC="eqns/princx9.gif" height=286 width=218 ALT=
"F = ZB = [.41  -.69  .06; -2.11  .07  .63; -.46  -.32  .30;
 1.62  -1.00  .70; .70  1.09  .65; -.86  1.32  -.85;
 -.60  -1.31  .86; .94  1.72  -.04; .22  .03  .34; .15  -.91  -2.65]">
</center>
-->
</TD>
</TR>
<!-- end paragraph -->

<!-- begin paragraph -->
<TR>
<TD WIDTH=15% VALIGN=top>
<!-- Add marginal notes below -->
<I>
Principal factors control chart
</I>
</TD>
<TD VALIGN=TOP WIDTH=85%>
<!-- Add main text below -->
These factors can be plotted against the indices, which could be
times.  If time is used, <i>the resulting plot is an example of a
principal factors control chart.</i>

</TD>
</TR>
<!-- end paragraph -->

   

   

   
</TABLE>

<IMG SRC="../../gifs/nvgbrbtm.gif" BORDER=0 USEMAP="#nvbar.nvbar">
<map name="nvbar.nvbar">
<area shape="rect" href="http://www.nist.gov/" coords="22,6,67,20">
<area shape="rect" href="http://www.sematech.org/" coords="3,23,92,40">
<area shape="rect" alt="Home" href="../../index-2.html" coords="114,12,165,31">
<area shape="rect" alt="Tools & Aids" href="../../toolaids.html" coords="190,12,290,31">
<area shape="rect" alt="Search Handbook" href="../../search.html" coords="318,14,376,30">
<area shape="rect" alt="Previous Page" href="pmc551.html" coords="428,15,471,29">
<area shape="rect" alt="Next Page" href="../section6/pmc6.html" coords="476,15,517,30">
<area shape="default" nohref>
</map>
   
</BODY>


<!-- Mirrored from www.itl.nist.gov/div898/handbook/pmc/section5/pmc552.htm by HTTrack Website Copier/3.x [XR&CO'2014], Fri, 17 Feb 2017 22:22:06 GMT -->
</HTML>
