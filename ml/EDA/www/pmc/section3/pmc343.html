
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">

<HTML>


<!-- Mirrored from www.itl.nist.gov/div898/handbook/pmc/section3/pmc343.htm by HTTrack Website Copier/3.x [XR&CO'2014], Fri, 17 Feb 2017 22:21:26 GMT -->
<HEAD>
<script async type="text/javascript"
        id="_fed_an_ua_tag"
        src="https://dap.digitalgov.gov/Universal-Federated-Analytics-Min.js?agency=DOC&amp;subagency=NIST&amp;pua=UA-37115410-50&amp;yt=true&amp;exts=ppsx,pps,f90,sch,rtf,wrl,txz,m1v,xlsm,msi,xsd,f,tif,eps,mpg,xml,pl,xlt,c">
</script>
<script type="text/javascript"
            src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=default.js">
</script>
<META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=iso-8859-1">
<META NAME="GENERATOR" CONTENT="Mozilla/4.05 [en] (WinNT; U) [Netscape]">
<TITLE>6.3.4.3. Multivariate EWMA Charts</TITLE>
</HEAD>

<BODY BGCOLOR="FFFFCC">

<IMG SRC="../../gifs/nvgtbr.gif" BORDER=0 VALIGN="TOP" ISMAP USEMAP="#MenuBar">
<map name="MenuBar">
<area shape="rect" alt="Next Page" href="../section4/pmc4.html" coords="463,27,504,45">
<area shape="rect" alt="Previous Page" href="pmc342.html" coords="417,28,459,45">
<area shape="rect" alt="Home" href="../../index-2.html" coords="52,0,100,43">
<area shape="rect" alt="Tools & Aids" href="../../toolaids.html" coords="165,27,264,46">
<area shape="rect" alt="Search Handbook" href="../../search.html" coords="307,28,366,44">
<area shape="default" nohref>
</map>
<BR>

<TABLE CELLSPACING=20 CELLPADDING=0 WIDTH=540>

<TR>
<TD VALIGN=TOP COLSPAN=2>
<FONT SIZE=-1>
<FONT COLOR="#D60021">6.</FONT>
<FONT COLOR="#00105A"><A HREF="../pmc.html">Process or Product Monitoring and Control</a></FONT>
<BR>
<FONT COLOR="#D60021">6.3.</FONT>
<FONT COLOR="#00105A"><A HREF="pmc3.html">Univariate and Multivariate Control Charts</a></FONT>
<BR>
<FONT COLOR="#D60021">6.3.4.</FONT>
<FONT COLOR="#00105A"><A HREF="pmc34.html">What are Multivariate Control Charts?</a></FONT>
<BR>
</FONT>
<BR>
<TABLE>
<TR>
<TD VALIGN=top>
<H2><FONT COLOR="#D60021">6.3.4.3.</FONT></H2>
</TD>
<TD VALIGN=top>
<H2>Multivariate EWMA Charts</H2>
</TD>
</TR >
</TABLE>
</TD>
</TR>





<!-- begin paragraph -->
<TR>
<TD WIDTH=15% VALIGN=top>
<!-- Add marginal notes below -->
<I>
</I>
</TD>
<TD VALIGN=TOP WIDTH=85%>
<!-- Add main text below -->
<b>Multivariate EWMA Control Chart</b>

</TD>
</TR>
<!-- end paragraph -->

<!-- begin paragraph -->
<TR>
<TD WIDTH=15% VALIGN=top>
<!-- Add marginal notes below -->
<I>
Univariate EWMA model
</I>
</TD>
<TD VALIGN=TOP WIDTH=85%>
<!-- Add main text below -->
The model for a univariate EWMA chart is given by:

$$ Z_i = \lambda X_i + (1-\lambda)Z_{i-1}, \,\,\,\,\,  i = 1, \, 2, \, \ldots, \, n \, , $$

<!-- <ul>
<img SRC="eqns/ewma1.gif"
ALT="Z(i) = lambda*X(i) + (1 - lambda)*Z(i-1)    i = 1, 2, ..., n">
</ul> -->

where \(Z_i\)
<!-- <i>Z<sub>i</sub></i> -->
is the \(i\)th EWMA, \(X_i\)
<!-- <i>X<sub>i</sub></i> -->
is the the \(i\)th observation, \(Z_0\)
<!-- <i>Z</i><sub>0</sub> -->
is the average from the historical data, and \(0 < \lambda \le 1\).
<!-- 0 < <img align=absmiddle src="eqns/lambda.gif" alt="lambda">
<img align=absmiddle src="eqns/le.gif" alt="<="> 1. -->
<!-- <img SRC="eqns/mewma1.gif" height=74 width=316> -->

</TD>
</TR>
<!-- end paragraph -->

<!-- begin paragraph -->
<TR>
<TD WIDTH=15% VALIGN=top>
<!-- Add marginal notes below -->
<I>
Multivariate EWMA model
</I>
</TD>
<TD VALIGN=TOP WIDTH=85%>
<!-- Add main text below -->
In the multivariate case, one can extend this formula to
<!-- <img SRC="eqns/mewma2.gif" height=264 width=250> -->

$$ Z_i = \Lambda X_i + (1-\Lambda)Z_{i-1} \, , $$

<!-- 
<ul>
<img SRC="eqns/mewma1a.gif"
     ALT="Z(i) = LAMBDA*X(i) + (1 - LAMBDA)*Z(i-1)">
</ul> 
-->
where \(Z_i\)
<!-- <i>Z<sub>i</sub></i> -->
is the \(i\)th
<!-- <i>i</i>th -->
EWMA vector, \(X_i\)
<!-- <i>X<sub>i</sub></i> -->
is the the \(i\)th
<!-- <i>i</i>th -->
observation vector \(i = 1, \, 2, \, \ldots, \, n\), \(Z_0\)
<!-- <i>i</i> = 1, 2, ..., <i>n</i>, <i>Z</i><sub>0</sub> -->
is the vector of variable values from the historical data,
\(\Lambda\) is the \(\mbox{diag}(\lambda_1, \, \lambda_2, \, \ldots, \, \lambda_p)\)
<!--
<img align=absmiddle src="eqns/uclambda.gif" alt="LAMBDA"> is the diag(
<img align=absmiddle src="eqns/lambda.gif" alt="lambda"><sub>1</sub>,
<img align=absmiddle src="eqns/lambda.gif" alt="lambda"><sub>2</sub>,
... , <img align=absmiddle src="eqns/lambda.gif" alt="lambda"><sub>p</sub>)
-->
which is a diagonal matrix with \(\lambda_1, \, \lambda_2, \, \ldots, \, \lambda_p\)
<!--
<img align=absmiddle src="eqns/lambda.gif" alt="lambda"><sub>1</sub>,
<img align=absmiddle src="eqns/lambda.gif" alt="lambda"><sub>2</sub>,
... , <img align=absmiddle src="eqns/lambda.gif" alt="lambda"><sub>p</sub>
-->
on the main diagonal, and \(p\)
<!-- <i>p</i> -->
is the number of variables; that is the number of elements in each vector.

</TD>
</TR>
<!-- end paragraph -->

<tr>
<td VALIGN=TOP WIDTH="15%">
<I>
Illustration of multivariate EWMA
</I>
</td>

<td VALIGN=TOP WIDTH="85%">
The following illustration may clarify this. There are \(p\)
<!-- <i>p</i> -->
variables and each variable contains \(n\)
<!-- <i>n</i> -->
observations.  The input data matrix looks like the following.

$$ \begin{array}{cccc}
X_{11} & X_{12} & \cdots & X_{1p} \\
X_{21} & X_{22} & \cdots & X_{2p} \\
\vdots & \vdots & \ddots & \vdots \\
       &        &        &        \\
X_{n1} & X_{n2} & \cdots & X_{np}
\end{array} $$

<!-- 
<ul>
<img SRC="eqns/mewma3.gif" height=165 width=134 ALT=
  "X11 X12 ... X1p;
   X21 X22 ... X2p;
        ....      ;
   Xn1 Xn2 ... Xnp">
</ul>
-->
The quantity to be plotted on the control chart is

$$ T_i^2 = Z_i' \, \Sigma_{Z_i}^{-1} \, Z_i $$

<!--
<ul>
<img SRC="eqns/mewma4.gif" height=72 width=88
     ALT="T(i)**2 = Z'(i)*SIGMA(z(i))**(-1)*Z(i)">
</ul>
-->
</td>
</tr>

<!-- begin paragraph -->
<TR>
<TD WIDTH=15% VALIGN=top>
<!-- Add marginal notes below -->
<I>
Simplification
</I>
</TD>
<TD VALIGN=TOP WIDTH=85%>
<!-- Add main text below -->
It has been shown (<a href="../section7/pmc7.html#Lowry,">Lowry et al.,
1992</a>) that the \( (k,l) \)th
<!-- (<i>k</i>,<i>l</i>)th -->
element of the covariance matrix of the \(i\)th
<!-- <i>i</i>th -->
EWMA, \(\Sigma_{Z_i}\),
<!-- <img align=absmiddle SRC="eqns/sigmazi.gif" alt="SIGMA(z(i))">, -->
is

$$ \Sigma_{Z_i}(k,l) = \lambda_k \lambda_l \,
\frac{\left[ 1-(1-\lambda_k)^i (1-\lambda_l)^i \right]}{(\lambda_k + \lambda_l - \lambda_k \lambda_l )} \,
\sigma_{k,l} \, ,  $$
<!--
<ul>
   <img align=absmiddle SRC="eqns/sigmazi2.gif" alt=
"SIGMA(z(i))(k,l) = lambda(k)*lambda(l)*
{[1 - (1 - lambda(k))**i*(1 - lambda(l))**i]/
[lambda(k) + lambda(l) - lambda(k)*lambda(l)]}*sigma(k,l)">
</ul>
-->
where \(\sigma_{k,l}\)
<!-- <img align=absmiddle SRC="eqns/sigmakl.gif" alt="sigma(k,l)"> -->
is the \((k,l)\)th
<!-- (<i>k</i>,<i>l</i>)th -->
element of \(\Sigma\),
<!-- <img align=absmiddle SRC="eqns/ucsigma.gif" alt="SIGMA">, -->
the covariance matrix of the \(X\)'s.
<p>
If \(\lambda_1 = \lambda_2 = \cdots = \lambda_p = \lambda\),
<!--
<img align=absmiddle src="eqns/lambda.gif" alt="lambda"><sub>1</sub> =
<img align=absmiddle src="eqns/lambda.gif" alt="lambda"><sub>2</sub> = ... =
<img align=absmiddle src="eqns/lambda.gif" alt="lambda"><sub>p</sub> =
<img align=absmiddle src="eqns/lambda.gif" alt="lambda">,
-->
then the above expression simplifies to

$$ \Sigma_{Z_i}(k,l) = \frac{\lambda}{2 - \lambda} \left[ 1-(1-\lambda)^{2i} \right] \Sigma \, , $$
<!--
<ul>
   <img align=absmiddle SRC="eqns/sigmazi3.gif" alt=
"SIGMA(z(i)) = (lambda/(2-lambda))*[1-(1-lambda)**(2*i)]*SIGMA">
</ul>
-->
where \(\Sigma\)
<!-- <img align=absmiddle SRC="eqns/ucsigma.gif" alt="SIGMA"> -->
is the covariance matrix of the input data.

<!-- <img SRC="eqns/mewma5.gif" height=296 width=501> -->

</TD>
</TR>
<!-- end paragraph -->

<!-- begin paragraph -->
<TR>
<TD WIDTH=15% VALIGN=top>
<!-- Add marginal notes below -->
<I>
Further simplification
</I>
</TD>
<TD VALIGN=TOP WIDTH=85%>
<!-- Add main text below -->
There is a further simplification.  When \(i\)
<!-- <i>i</i> -->
becomes large, the covariance matrix may be expressed as:

$$ \Sigma_{Z_i} = \frac{\lambda}{2 - \lambda} \Sigma \, . $$
<!--
<center>
<img SRC="eqns/mewma6.gif" height=110 width=85
     ALT="SIGMA(z(i)) = (lambda/(2-lambda))*SIGMA">
</center>
-->
The question is "What is large?".  When we examine the formula with
the \(2i\)
<!-- 2<i>i</i> -->
in it, we observe that when \(2i\)
<!-- 2<i>i</i> -->
becomes sufficiently large such that \((1-\lambda)^{2i}\)
<!-- (1 - <img align=absmiddle src="eqns/lambda.gif" alt="lambda">) <sup>2<i>i</i></sup> -->
becomes almost zero, then we can use the simplified formula.
</TD>
</TR>
<!-- end paragraph -->

<!-- begin paragraph -->
<TR>
<TD WIDTH=15% VALIGN=top>
<!-- Add marginal notes below -->
<I>
Table for selected values of \(\lambda\) and \(i\)
<!-- <img align=absmiddle src="eqns/lambda.gif" alt="lambda"> and i -->
</I>
</TD>
<TD VALIGN=TOP WIDTH=85%>
<!-- Add main text below -->
The following table gives the values of \((1-\lambda)^{2i}\)
<!-- (1-<img align=absmiddle src="eqns/lambda.gif" alt="lambda">)<sup>2<i>i</i></sup> -->
for selected values of \(\lambda\) and \(i\).
<!-- <img align=bottom src="eqns/lambda.gif" alt="lambda"> and <i>i</i>. -->
<p>
<table width=400>
<tr>
   <th valign=top align=center>
      &nbsp;
   </th>
   <th valign=top align=center colspan=9>
      \(2i\)
   </th>
</tr>
<tr>
   <th vvalign=top align=center>
      \(1 - \lambda\)
      <!-- <img align=absmiddle src="eqns/lambda.gif" alt="gif"> -->
   </th>
   <th vvalign=top align=center>
      4
   </th>
   <th vvalign=top align=center>
      6
   </th>
   <th vvalign=top align=center>
      8
   </th>
   <th vvalign=top align=center>
      10
   </th>
   <th vvalign=top align=center>
      12
   </th>
   <th vvalign=top align=center>
      20
   </th>
   <th vvalign=top align=center>
      30
   </th>
   <th vvalign=top align=center>
      40
   </th>
   <th vvalign=top align=center>
      50
   </th>
</tr>
<tr>
   <th vvalign=top align=center>
      0.9
   </th>
   <td vvalign=top align=center>
      0.656
   </td>
   <td vvalign=top align=center>
      0.531
   </td>
   <td vvalign=top align=center>
      0.430
   </td>
   <td vvalign=top align=center>
      0.349
   </td>
   <td vvalign=top align=center>
      0.282
   </td>
   <td vvalign=top align=center>
      0.122
   </td>
   <td vvalign=top align=center>
      0.042
   </td>
   <td vvalign=top align=center>
      0.015
   </td>
   <td vvalign=top align=center>
      0.005
   </td>
</tr>
<tr>
   <th vvalign=top align=center>
      0.8
   </th>
   <td vvalign=top align=center>
      0.410
   </td>
   <td vvalign=top align=center>
      0.262
   </td>
   <td vvalign=top align=center>
      0.168
   </td>
   <td vvalign=top align=center>
      0.107
   </td>
   <td vvalign=top align=center>
      0.069
   </td>
   <td vvalign=top align=center>
      0.012
   </td>
   <td vvalign=top align=center>
      0.001
   </td>
   <td vvalign=top align=center>
      0.000
   </td>
   <td vvalign=top align=center>
      0.000
   </td>
</tr>
<tr>
   <th vvalign=top align=center>
      0.7
   </th>
   <td vvalign=top align=center>
      0.240
   </td>
   <td vvalign=top align=center>
      0.118
   </td>
   <td vvalign=top align=center>
      0.058
   </td>
   <td vvalign=top align=center>
      0.028
   </td>
   <td vvalign=top align=center>
      0.014
   </td>
   <td vvalign=top align=center>
      0.001
   </td>
   <td vvalign=top align=center>
      0.000
   </td>
   <td vvalign=top align=center>
      0.000
   </td>
   <td vvalign=top align=center>
      0.000
   </td>
</tr>
<tr>
   <th vvalign=top align=center>
      0.6
   </th>
   <td vvalign=top align=center>
      0.130
   </td>
   <td vvalign=top align=center>
      0.047
   </td>
   <td vvalign=top align=center>
      0.017
   </td>
   <td vvalign=top align=center>
      0.006
   </td>
   <td vvalign=top align=center>
      0.002
   </td>
   <td vvalign=top align=center>
      0.000
   </td>
   <td vvalign=top align=center>
      0.000
   </td>
   <td vvalign=top align=center>
      0.000
   </td>
   <td vvalign=top align=center>
      0.000
   </td>
</tr>
<tr>
   <th vvalign=top align=center>
      0.5
   </th>
   <td vvalign=top align=center>
      0.063
   </td>
   <td vvalign=top align=center>
      0.016
   </td>
   <td vvalign=top align=center>
      0.004
   </td>
   <td vvalign=top align=center>
      0.001
   </td>
   <td vvalign=top align=center>
      0.000
   </td>
   <td vvalign=top align=center>
      0.000
   </td>
   <td vvalign=top align=center>
      0.000
   </td>
   <td vvalign=top align=center>
      0.000
   </td>
   <td vvalign=top align=center>
      0.000
   </td>
</tr>
<tr>
   <th vvalign=top align=center>
      0.4
   </th>
   <td vvalign=top align=center>
      0.026
   </td>
   <td vvalign=top align=center>
      0.004
   </td>
   <td vvalign=top align=center>
      0.001
   </td>
   <td vvalign=top align=center>
      0.000
   </td>
   <td vvalign=top align=center>
      0.000
   </td>
   <td vvalign=top align=center>
      0.000
   </td>
   <td vvalign=top align=center>
      0.000
   </td>
   <td vvalign=top align=center>
      0.000
   </td>
   <td vvalign=top align=center>
      0.000
   </td>
</tr>
<tr>
   <th vvalign=top align=center>
      0.3
   </th>
   <td vvalign=top align=center>
      0.008
   </td>
   <td vvalign=top align=center>
      0.001
   </td>
   <td vvalign=top align=center>
      0.000
   </td>
   <td vvalign=top align=center>
      0.000
   </td>
   <td vvalign=top align=center>
      0.000
   </td>
   <td vvalign=top align=center>
      0.000
   </td>
   <td vvalign=top align=center>
      0.000
   </td>
   <td vvalign=top align=center>
      0.000
   </td>
   <td vvalign=top align=center>
      0.000
   </td>
</tr>
<tr>
   <th vvalign=top align=center>
      0.2
   </th>
   <td vvalign=top align=center>
      0.002
   </td>
   <td vvalign=top align=center>
      0.000
   </td>
   <td vvalign=top align=center>
      0.000
   </td>
   <td vvalign=top align=center>
      0.000
   </td>
   <td vvalign=top align=center>
      0.000
   </td>
   <td vvalign=top align=center>
      0.000
   </td>
   <td vvalign=top align=center>
      0.000
   </td>
   <td vvalign=top align=center>
      0.000
   </td>
   <td vvalign=top align=center>
      0.000
   </td>
</tr>
<tr>
   <th vvalign=top align=center>
      0.1
   </th>
   <td vvalign=top align=center>
      0.000
   </td>
   <td vvalign=top align=center>
      0.000
   </td>
   <td vvalign=top align=center>
      0.000
   </td>
   <td vvalign=top align=center>
      0.000
   </td>
   <td vvalign=top align=center>
      0.000
   </td>
   <td vvalign=top align=center>
      0.000
   </td>
   <td vvalign=top align=center>
      0.000
   </td>
   <td vvalign=top align=center>
      0.000
   </td>
   <td vvalign=top align=center>
      0.000
   </td>
</tr>
</table>
<!-- <img SRC="eqns/mewma7.gif" height=306 width=412> -->

</TD>
</TR>
<!-- end paragraph -->

<!-- begin paragraph -->
<TR>
<TD WIDTH=15% VALIGN=top>
<!-- Add marginal notes below -->
<I>
Simplified formula not required
</I>
</TD>
<TD VALIGN=TOP WIDTH=85%>
<!-- Add main text below -->
It should be pointed out that a well-meaning computer program does
not have to adhere to the simplified formula, and potential
inaccuracies for low values for \(\lambda\) and \(i\)
<!-- <img align=bottom src="eqns/lambda.gif" alt="lambda"> and <i>i</i> -->
can thus be avoided.

</TD>
</TR>
<!-- end paragraph -->

<!-- 
</TABLE>
<TABLE CELLSPACING=20 CELLPADDING=0 WIDTH=540>
-->

<!-- begin paragraph -->
<TR>
<TD WIDTH=15% VALIGN=top>
<!-- Add marginal notes below -->
<I>
MEWMA computer output for the Lowry data 
</I>
</TD>
<TD VALIGN=TOP WIDTH=85%>
<!-- Add main text below -->
Here is an example of the application of an MEWMA control chart. To
faciltate comparison with existing literature, we used data from
Lowry et al.  The data were simulated from a bivariate normal
distribution with unit variances and a correlation coefficient
of 0.5. The value for \(\lambda = 0.10\)
<!-- <img align=bottom src="eqns/lambda.gif" alt="lambda"> = .10 -->
and the values for \(T_i^2\)
<!-- <img align=absmiddle src="eqns/t2i.gif" alt="T(i)^2"> -->
were obtained by the equation
given above.  The covariance of the MEWMA vectors was obtained
by using the non-simplified equation.  That means that for each
MEWMA control statistic, the computer computed a covariance matrix,
where \(i = 1, \, 2, \, \ldots, \, 10\).
<!-- <i>i</i> = 1, 2, ...10. -->
The results of the computer routine
are:
<PRE>

*****************************************************
*      Multi-Variate EWMA Control Chart             *
*****************************************************

DATA SERIES            MEWMA Vector          MEWMA
   1          2          1         2       STATISTIC
-1.190     0.590     -0.119     0.059        2.1886
 0.120     0.900     -0.095     0.143        2.0697
-1.690     0.400     -0.255     0.169        4.8365
 0.300     0.460     -0.199     0.198        3.4158
 0.890    -0.750     -0.090     0.103        0.7089
 0.820     0.980      0.001     0.191        0.9268
-0.300     2.280     -0.029     0.400        4.0018
 0.630     1.750      0.037     0.535        6.1657
 1.560     1.580      0.189     0.639        7.8554
 1.460     3.050      0.316     0.880       14.4158


VEC    XBAR      MSE      Lamda
 1     .260     1.200     0.100
 2    1.124     1.774     0.100


</PRE>
The <i>UCL</i> = 5.938 for \(\alpha = 0.05\).
<!-- <img align=absmiddle src="eqns/alpha.gif" alt="alpha"> = .05. -->
Smaller choices of \(\alpha\)
<!-- <img align=absmiddle src="eqns/alpha.gif" alt="alpha"> -->
are also used.

</TD>
</TR>
<!-- end paragraph -->

</TABLE>
<TABLE CELLSPACING=20 CELLPADDING=0 WIDTH=540>

<!-- begin paragraph -->
<TR>
<TD WIDTH=15% VALIGN=top>
<!-- Add marginal notes below -->
<I>
Sample MEWMA plot
</I>
</TD>
<TD VALIGN=TOP WIDTH=85%>
<!-- Add main text below -->
The following is the plot of the above MEWMA.
<center>
<img SRC="gifs/mewma.gif" height=267 width=400
     ALT="Sample MEWMA plot of the above data">
</center>

</TD>
</TR>
<!-- end paragraph -->



   
</TABLE>

<IMG SRC="../../gifs/nvgbrbtm.gif" BORDER=0 USEMAP="#nvbar.nvbar">
<map name="nvbar.nvbar">
<area shape="rect" href="http://www.nist.gov/" coords="22,6,67,20">
<area shape="rect" href="http://www.sematech.org/" coords="3,23,92,40">
<area shape="rect" alt="Home" href="../../index-2.html" coords="114,12,165,31">
<area shape="rect" alt="Tools & Aids" href="../../toolaids.html" coords="190,12,290,31">
<area shape="rect" alt="Search Handbook" href="../../search.html" coords="318,14,376,30">
<area shape="rect" alt="Previous Page" href="pmc342.html" coords="428,15,471,29">
<area shape="rect" alt="Next Page" href="../section4/pmc4.html" coords="476,15,517,30">
<area shape="default" nohref>
</map>
   
</BODY>


<!-- Mirrored from www.itl.nist.gov/div898/handbook/pmc/section3/pmc343.htm by HTTrack Website Copier/3.x [XR&CO'2014], Fri, 17 Feb 2017 22:21:27 GMT -->
</HTML>
