<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">

<HTML>

<!-- Mirrored from www.itl.nist.gov/div898/handbook/eda/section3/eda35f.htm by HTTrack Website Copier/3.x [XR&CO'2014], Fri, 17 Feb 2017 21:51:18 GMT -->
<HEAD>
<script async type="text/javascript"
        id="_fed_an_ua_tag"
        src="https://dap.digitalgov.gov/Universal-Federated-Analytics-Min.js?agency=DOC&amp;subagency=NIST&amp;pua=UA-37115410-50&amp;yt=true&amp;exts=ppsx,pps,f90,sch,rtf,wrl,txz,m1v,xlsm,msi,xsd,f,tif,eps,mpg,xml,pl,xlt,c">
</script>
<script type="text/javascript" src=
"https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=default.js">
</script>
<META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=iso-8859-1">
<META NAME="GENERATOR" CONTENT="Mozilla/4.05 [en] (WinNT; U) [Netscape]">
<TITLE>1.3.5.15. Chi-Square Goodness-of-Fit Test</TITLE>
</HEAD>

<BODY BGCOLOR="FFFFCC">

<IMG SRC="../../gifs/nvgtbr.gif" BORDER=0 VALIGN="TOP" ISMAP USEMAP="#MenuBar">
<map name="MenuBar">
<area shape="rect" alt="Next Page" href="eda35g.html" coords="463,27,504,45">
<area shape="rect" alt="Previous Page" href="eda35e.html" coords="417,28,459,45">
<area shape="rect" alt="Home" href="../../index-2.html" coords="52,0,100,43">
<area shape="rect" alt="Tools & Aids" href="../../toolaids.html" coords="165,27,264,46">
<area shape="rect" alt="Search Handbook" href="../../search.html" coords="307,28,366,44">
<area shape="default" nohref>
</map>
<BR>

<TABLE CELLSPACING=20 CELLPADDING=0 WIDTH=540>

<TR>
<TD VALIGN=TOP COLSPAN=2>
<FONT SIZE=-1>
<FONT COLOR="#D60021">1.</FONT>
<FONT COLOR="#00105A"><A HREF="../eda.html">Exploratory Data Analysis</a></FONT>
<BR>
<FONT COLOR="#D60021">1.3.</FONT>
<FONT COLOR="#00105A"><A HREF="eda3.html">EDA Techniques</a></FONT>
<BR>
<FONT COLOR="#D60021">1.3.5.</FONT>
<FONT COLOR="#00105A"><A HREF="eda35.html">Quantitative Techniques</a></FONT>
<BR>
</FONT>
<BR>
<TABLE>
<TR>
<TD VALIGN=top>
<H2><FONT COLOR="#D60021">1.3.5.15.</FONT></H2>
</TD>
<TD VALIGN=top>
<H2>Chi-Square Goodness-of-Fit Test</H2>
</TD>
</TR >
</TABLE>
</TD>
</TR>










<!-----begin section: purpose -->

<tr>
   <td width=15% valign=top>
      <I>Purpose:<br>
         Test for distributional adequacy
      </I>
   </td>
   <td width=85% valign=top>
      The chi-square test
      (<a href="../section4/eda43.html#Snedecor">Snedecor and Cochran,
      1989</a>) is used to test if a sample
      of data came from a population with a specific distribution.
      <p>
      An attractive feature of the chi-square goodness-of-fit
      test is that it can be applied to any univariate distribution
      for which you can calculate the
      <a href="eda362.html#CDF">cumulative distribution function</a>.
      The chi-square goodness-of-fit test is applied to binned data
      (i.e., data put into classes).  This is actually not a
      restriction since for non-binned data you can simply calculate a
      histogram or frequency table before generating the chi-square
      test.  However, the value of the chi-square test statistic are
      dependent on how the data is binned.  Another disadvantage
      of the chi-square test is that it requires a sufficient 
      sample size in order for the chi-square approximation
      to be valid.
      <p>
      The chi-square test is an alternative to the
      <a href="eda35e.html"> Anderson-Darling</a> and
      <a href="eda35g.html">Kolmogorov-Smirnov</a> goodness-of-fit
      tests.  The chi-square goodness-of-fit test can be applied to
      discrete distributions such as the
      <a href="eda366i.html">binomial</a> and the
      <a href="eda366j.html">Poisson</a>.
      The Kolmogorov-Smirnov and Anderson-Darling
      tests are restricted to continuous distributions.
      <p>
      Additional discussion of the chi-square goodness-of-fit
      test is contained in the <a href="../../prc/section2/prc211.html">
      product and process comparisons</a> chapter (chapter 7).

   </td>
</tr>

<!-----begin section: definition -->

<tr>
   <td width=15% valign=top>
      <I>Definition
      </I>
   </td>
   <td width=85% valign=top>
      The chi-square test is defined for the hypothesis:
      <table>

      <tr>
         <td>
            H<sub>0</sub>:
         </td>
         <td>
            The data follow a specified distribution.
         </td>
       </tr>
      <tr>
         <td valign=top>
            H<sub>a</sub>:
         </td>
         <td>
            The data do not follow the specified distribution.
         </td>
      </tr>
      <p>
      <tr>
         <td valign=top>
            Test Statistic:
         </td>
         <td>
            For the chi-square goodness-of-fit computation, the data
            are divided into <i>k</i> bins and the test statistic is
            defined as
            <ul>
               <!--
               <img src="eqns/chisqgf.gif" alt=
"CHI-SQUARE=SUM(O(i)-E(i))**2/E(i) where the summation is from 1 to k">
               -->
               \[ \chi^{2} = \sum_{i=1}^{k}(O_{i} - E_{i})^{2}/E_{i} \]
            </ul>
            where <!-- <img src="eqns/oi.gif" alt="O(I)"> -->
            \(O_{i}\) is the observed frequency for bin <i>i</i> and
            <!-- <img src="eqns/ei.gif" alt="E(i)"> --> \(E_{i}\)
            is the expected frequency for bin <i>i</i>.  The expected
            frequency is calculated by
            <ul>
               <!--
               <img src="eqns/expefreq.gif"
                    alt="E(i) = N*(F(Y(u) - F(Y(l))">
               -->
               \[ E_{i} = N(F(Y_{u}) - F(Y_{l})) \]
            </ul>
            where <b><i>F</i></b> is the <a href=
            "eda362.html#CDF">cumulative distribution function</a> for the
            distribution being tested, <b><i>Y<sub>u</sub></i></b> is the
            upper limit for class <b><i>i</i></b>,
            <b><i>Y<sub>l</sub></i></b> is the lower limit for class
            <b><i>i</i></b>, and <i>N</i> is the sample size.
            <p>
            This test is sensitive to the choice of bins.  There
            is no optimal choice for the bin width (since the 
            optimal bin width depends on the distribution).
            Most reasonable choices should produce similar, but not
            identical, results.  For the chi-square approximation to 
            be valid, the expected frequency should be at least 5.  
            This test is not valid for small samples, and if some of 
            the counts are less than five, you may need
            to combine some bins in the tails.
         </td
       </tr>
      <tr>
         <td valign=top> Significance Level:
         </td>
         <td valign=top>
            <!-- <img src="eqns/alpha.gif" alt="alpha">. -->
            <big><i>&alpha;</i></big>
         </td>
       </tr>
      <tr>
         <td valign=top>
            Critical Region:
         </td>
         <td>
            The test statistic follows, approximately, a chi-square
            distribution with (<i>k</i> - <i>c</i>) degrees of freedom
            where <i>k</i> is the number of non-empty cells and
            <i>c</i> = the number of estimated parameters (including
            <a href="eda364.html">location and scale parameters</a>
            and <a href="eda363.html">shape parameters</a>) for the
            distribution + 1.  For example, for a 3-parameter Weibull
            distribution, <i>c</i> = 4.
            <p>
            Therefore, the hypothesis that the data are from a
            population with the specified distribution is rejected if
            <ul>
               <!--
               <img src="eda35f_e1.gif"
                    alt="CHI-SQUARE > CHI-SQUARE(1-alpha,k-c)">
               -->
               \[ \chi^2 > \chi^2_{1-\alpha, \, k-c} \]
            </ul>
            where
            <!-- <img align=absbottom src="eda35f_e2.gif" alt=
            "CHI-SQUARE(1-alpha,k-c)"> -->
            \(\chi^2_{1-\alpha, \, k-c}\)
            is the chi-square critical value with <i>k</i> - <i>c</i>
            degrees of freedom and significance level <i>&alpha;</i>.
         </td>
       </tr>

     </table>
    
   </td>
</tr>

<!-----begin section: sample output -->

<br>
<tr>
   <td width=15% valign=top>
      <I>Chi-Square Test Example<br>
      </I>
   </td>
   <td width=85% valign=top>
      We generated 1,000 random numbers for normal,
      double exponential, <i>t</i> with 3 degrees
      of freedom, and lognormal distributions.  In all cases,
      a chi-square test with <I>k</I> = 32 bins was applied to test 
      for normally distributed data.  Because the normal distribution
      has two parameters, <I>c</I> = 2 + 1 = 3
      <P>
      The normal random numbers were stored in the variable Y1,
      the double exponential random numbers were stored in the
      variable Y2, the <i>t</i> random numbers were stored in the
      variable Y3, and the lognormal random numbers were stored
      in the variable Y4.
      
<PRE>
H<SUB>0</SUB>:  the data are normally distributed
H<SUB>a</SUB>:  the data are not normally distributed  

Y1 Test statistic:  <I>&Chi;</I><sup>&thinsp;2</sup> =   32.256
Y2 Test statistic:  <I>&Chi;</I><sup>&thinsp;2</sup> =   91.776
Y3 Test statistic:  <I>&Chi;</I><sup>&thinsp;2</sup> =  101.488
Y4 Test statistic:  <I>&Chi;</I><sup>&thinsp;2</sup> = 1085.104

Significance level:  <i>&alpha;</i> = 0.05
Degrees of freedom:  <i>k</i> - <i>c</i> = 32 - 3 = 29
Critical value:  <I>&Chi;</I><sup>&thinsp;2</sup><sub>1-<i>&alpha;</i>,&thinsp;<i>k</i>-<i>c</i></sub> = 42.557
Critical region: Reject H<SUB>0</SUB> if <I>&Chi;</I><sup>&thinsp;2</sup> > 42.557
</PRE>

As we would hope, the chi-square test fails to reject the
null hypothesis for the normally distributed data set and
rejects the null hypothesis for the three non-normal data sets.
</td>
</tr>

<!-----begin section: questions -->
<tr>
   <td width=15% valign=top>
      <I>Questions
      </I>
   </td>
   <td width=85% valign=top>
      The chi-square test can be used to answer the following
      types of questions:
      <ul>
         <li>Are the data from a normal distribution?
         <li>Are the data from a log-normal distribution?
         <li>Are the data from a Weibull distribution?
         <li>Are the data from an exponential distribution?
         <li>Are the data from a logistic distribution?
         <li>Are the data from a binomial distribution?
      </ul>

   </td>
</tr>

<!-----begin section: importance -->

<br>
<tr>
   <td width=15% valign=top>
      <I>Importance
      </I>
   </td>
   <td width=85% valign=top>
      Many statistical tests and procedures are based on specific
      distributional <a href="../section2/eda2.html">assumptions</a>.
      The assumption of normality
      is particularly common in classical statistical tests.
      Much reliability modeling is based on the assumption that
      the distribution of the data follows a Weibull distribution.
      <p>
      There are many non-parametric and robust techniques that
      are not based on strong distributional assumptions.  By
      non-parametric, we mean a technique, such as the sign test,
      that is not based on a specific distributional assumption.
      By robust, we mean a statistical technique that performs well
      under a wide range of distributional assumptions.
      However, techniques based on specific distributional assumptions
      are in general more powerful than these non-parametric and
      robust techniques.  By power, we mean the ability to detect
      a difference when that difference actually exists.  Therefore,
      if the distributional assumption can be confirmed, the
      parametric techniques are generally preferred.
      <p>
      If you are using a technique that makes a normality (or some
      other type of distributional) assumption, it is important to
      confirm that this assumption is in fact justified.  If
      it is, the more powerful parametric techniques can be used.
      If the distributional assumption is not justified,
      a non-parametric or robust technique may be required.

   </td>
</tr>

<!-----begin section: related techniques -->

<tr>
   <td width=15% valign=top>
      <I>Related Techniques</I>
   </td>
   <td width=85% valign=top>
      <a href="eda35e.html">Anderson-Darling Goodness-of-Fit Test</a><br>
      <a href="eda35g.html">Kolmogorov-Smirnov Test</a><br> 
      <a href="../../prc/section2/prc213.html">Shapiro-Wilk
            Normality Test</a><br>
      <a href="probplot.html">Probability Plots</a><br> 
      <a href="ppccplot.html">Probability Plot Correlation Coefficient
         Plot</a><br> 

   </td>
</tr>


<!-- begin paragraph -->
<TR>
<TD WIDTH=15% VALIGN=top>
<!-- Add marginal notes below -->
<I>
Software
</I>
</TD>
<TD WIDTH=85%>
<!-- Add main text below -->
Some general purpose statistical software programs provide a
chi-square goodness-of-fit test for at least some of the common
distributions.  Both <a href="eda35f.dp">Dataplot code</a> and 
<a href="eda35f.r">R code</a> can be used to generate the
analyses in this section.
</TD>
</TR>
<!-- end paragraph -->

<!-----end jjf----->








</TABLE>

<IMG SRC="../../gifs/nvgbrbtm.gif" BORDER=0 USEMAP="#nvbar.nvbar">
<map name="nvbar.nvbar">
<area shape="rect" href="http://www.nist.gov/" coords="22,6,67,20">
<area shape="rect" href="http://www.sematech.org/" coords="3,23,92,40">
<area shape="rect" alt="Home" href="../../index-2.html" coords="114,12,165,31">
<area shape="rect" alt="Tools & Aids" href="../../toolaids.html" coords="190,12,290,31">
<area shape="rect" alt="Search Handbook" href="../../search.html" coords="318,14,376,30">
<area shape="rect" alt="Previous Page" href="eda35e.html" coords="428,15,471,29">
<area shape="rect" alt="Next Page" href="eda35g.html" coords="476,15,517,30">
<area shape="default" nohref>
</map>
   
</BODY>


<!-- Mirrored from www.itl.nist.gov/div898/handbook/eda/section3/eda35f.htm by HTTrack Website Copier/3.x [XR&CO'2014], Fri, 17 Feb 2017 21:51:19 GMT -->
</HTML>
