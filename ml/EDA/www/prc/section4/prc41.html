
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">

<HTML>


<!-- Mirrored from www.itl.nist.gov/div898/handbook/prc/section4/prc41.htm by HTTrack Website Copier/3.x [XR&CO'2014], Fri, 17 Feb 2017 21:49:13 GMT -->
<HEAD>
<script async type="text/javascript"
        id="_fed_an_ua_tag"
        src="https://dap.digitalgov.gov/Universal-Federated-Analytics-Min.js?agency=DOC&amp;subagency=NIST&amp;pua=UA-37115410-50&amp;yt=true&amp;exts=ppsx,pps,f90,sch,rtf,wrl,txz,m1v,xlsm,msi,xsd,f,tif,eps,mpg,xml,pl,xlt,c">
</script>
<script type="text/javascript"
            src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=default.js">
</script>
<META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=iso-8859-1">
<META NAME="GENERATOR" CONTENT="Mozilla/4.05 [en] (WinNT; U) [Netscape]">
<TITLE>7.4.1. How can we compare several populations with unknown distributions (the Kruskal-Wallis test)?</TITLE>
</HEAD>

<BODY BGCOLOR="FFFFCC">

<IMG SRC="../../gifs/nvgtbr.gif" BORDER=0 VALIGN="TOP" ISMAP USEMAP="#MenuBar">
<map name="MenuBar">
<area shape="rect" alt="Next Page" href="prc42.html" coords="463,27,504,45">
<area shape="rect" alt="Previous Page" href="prc4.html" coords="417,28,459,45">
<area shape="rect" alt="Home" href="../../index-2.html" coords="52,0,100,43">
<area shape="rect" alt="Tools & Aids" href="../../toolaids.html" coords="165,27,264,46">
<area shape="rect" alt="Search Handbook" href="../../search.html" coords="307,28,366,44">
<area shape="default" nohref>
</map>
<BR>

<TABLE CELLSPACING=20 CELLPADDING=0 WIDTH=540>

<TR>
<TD VALIGN=TOP COLSPAN=2>
<FONT SIZE=-1>
<FONT COLOR="#D60021">7.</FONT>
<FONT COLOR="#00105A"><A HREF="../prc.html">Product and Process Comparisons</a></FONT>
<BR>
<FONT COLOR="#D60021">7.4.</FONT>
<FONT COLOR="#00105A"><A HREF="prc4.html">Comparisons based on data from more than two processes</a></FONT>
<BR>
</FONT>
<BR>
<TABLE>
<TR>
<TD VALIGN=top>
<H2><FONT COLOR="#D60021">7.4.1.</FONT></H2>
</TD>
<TD VALIGN=top>
<H2>How can we compare several populations with unknown distributions (the Kruskal-Wallis test)?</H2>
</TD>
</TR >
</TABLE>
</TD>
</TR>








<!-- begin paragraph -->
<TR>
<TD WIDTH=15% VALIGN=top>
<!-- Add marginal notes below -->
<I>
</I>
</TD>
<TD VALIGN=TOP WIDTH=85%>
<!-- Add main text below -->
<a NAME="Kruskal-Wallis"></a>
<b>The Kruskal-Wallis (KW) Test for Comparing Populations with
Unknown Distributions</b>

</TD>
</TR>
<!-- end paragraph -->

<!-- begin paragraph -->
<TR>
<TD WIDTH=15% VALIGN=top>
<!-- Add marginal notes below -->
<i>A nonparametric test for comparing population medians by Kruskal
and Wallis</i>
</TD>
<TD VALIGN=TOP WIDTH=85%>
<!-- Add main text below -->
The KW procedure tests the null hypothesis that \(k\)
<!-- <i>k</i> -->
samples from possibly different populations actually originate from
similar populations, at least as far as their central tendencies,
or medians, are concerned. The test assumes that the variables under
consideration have underlying continuous distributions.
<p>
In what follows assume we have \(k\)
<!-- <i>k</i>  -->
samples, and the sample size of the \(i\)-th
<!-- <i>i</i>-th -->
sample is \(n_i, \,\, i=1, \, 2, \, \ldots, \, k\).
<!-- <i>n<sub>i</sub>, i</i> = 1, 2, . . ., <i>k</i>. -->

</TD>
</TR>
<!-- end paragraph -->

<!-- begin paragraph -->
<TR>
<TD WIDTH=15% VALIGN=top>
<!-- Add marginal notes below -->
<I>
Test based on ranks of combined data
</I>
</TD>
<TD VALIGN=TOP WIDTH=85%>
<!-- Add main text below -->
In the computation of the KW statistic, each observation is replaced
by its rank in an ordered combination of all the \(k\)
<!-- <i>k</i> -->
samples.  By this we mean that the data from the \(k\)
<!-- <i>k</i> --> 
samples combined are ranked in a single series.  The minimum observation is replaced
by a rank of 1, the next-to-the-smallest by a rank of 2, and the
largest or maximum observation is replaced by the rank of \(N\),
<!-- <i>N</i>, -->
where \(N\)
<!-- <i>N</i> -->
is the total number of observations in all the samples (\(N\)
<!-- <i>N</i> -->
is the sum of the \(n_i\)).
<!-- <i>n<sub>i</sub></i>). -->

</TD>
</TR>
<!-- end paragraph -->

<!-- begin paragraph -->
<TR>
<TD WIDTH=15% VALIGN=top>
<!-- Add marginal notes below -->
<I>
Compute the sum of the ranks for each sample
</I>
</TD>
<TD VALIGN=TOP WIDTH=85%>
<!-- Add main text below -->
The next step is to compute the sum of the ranks for each of the
original samples.  The KW test determines whether these sums of
ranks are so different by sample that they are not likely to have
all come from the same population.

</TD>
</TR>
<!-- end paragraph -->

<!-- begin paragraph -->
<TR>
<TD WIDTH=15% VALIGN=top>
<!-- Add marginal notes below -->
<I>
Test statistic follows a \(\chi^2\)
<!-- <img align=absmiddle src="eqns/chisq.gif" alt="Chi-Square"> <sup>2</sup> -->
distribution
</I>
</TD>
<TD VALIGN=TOP WIDTH=85%>
<!-- Add main text below -->
It can be shown that if the \(k\)
<!-- <i>k</i> --> 
samples come from the same population, that is, if the null hypothesis is true, 
then the test statistic, \(H\),
<!-- <i>H</i>, -->
used in the KW procedure is distributed approximately as a chi-square statistic with
<i>df</i> = \(k-1\),
<!-- <i>k</i> - 1, -->
provided that the sample sizes of the \(k\)
<!-- <i>k</i> -->
samples are not too small (say, \(n_i > 4\),
<!-- <i>n</i><sub>i</sub>>4, -->
for all \(i\)).
<!-- <i>i</i>). -->
\(H\)
<!-- <i>H</i> -->
is defined as follows:

$$ H = \frac{12}{N(N+1)} \, \sum_{i=1}^k \frac{R_i^2}{n_i} - 3(N+1) \, , $$

<!--
<center><p>
<img SRC="eqns/kw1.gif" height=94 width=201 ALT=
"H = (12/(N*(N+1))*SUM[i=1 to k][R(i)**2/n(i)] - 3*(N+1)">
</center>
-->

where
<ul>
   <li>\(k\)
       <!-- <i>k</i> -->
       = number of samples (groups)
   <li>\(n_i\)
       <!-- <i>n<sub>i</sub></i> -->
       = number of observations for the \(i\)-th
       <!-- <i>i</i>-th -->
       sample or group
   <li>\(N\)
       <!-- <i>N</i> -->
       = total number of observations (sum of all the \(n_i\))
       <!-- <i>n<sub>i</sub></i>) -->
   <li>\(R_i\)
       <!-- <i>R</i><sub>i</sub> -->
       = sum of ranks for group \(i\)
       <!-- <i>i</i> -->
</ul>

</TD>
</TR>
<!-- end paragraph -->

<td valign=top width="15%">
<I>
</I>
</td>

<td valign=top width="85%">
<b>Example</b>

</td>
</tr>

<!-- begin paragraph -->
<TR>
<TD WIDTH=15% VALIGN=top>
<!-- Add marginal notes below -->
<i>An illustrative example</i>
</TD>
<TD VALIGN=TOP WIDTH=85%>
<!-- Add main text below -->
The following data are from a comparison of four investment firms. The
observations represent percentage of growth during a three month period.for
recommended funds.
<br>&nbsp;
<table CELLPADDING=2 WIDTH="50%" >
<tr ALIGN=CENTER>
<td WIDTH="25%">A</td>

<td WIDTH="25%">B</td>

<td WIDTH="25%">C</td>

<td WIDTH="25%">D</td>
</tr>

<tr>
<td COLSPAN="4">
<hr></td>
</tr>

<tr ALIGN=CENTER>
<td>4.2</td>

<td>3.3</td>

<td>1.9</td>

<td>3.5</td>
</tr>

<tr ALIGN=CENTER>
<td>4.6</td>

<td>2.4</td>

<td>2.4</td>

<td>3.1</td>
</tr>

<tr ALIGN=CENTER>
<td>3.9</td>

<td>2.6</td>

<td>2.1</td>

<td>3.7</td>
</tr>

<tr ALIGN=CENTER>
<td>4.0</td>

<td>3.8</td>

<td>2.7</td>

<td>4.1</td>
</tr>

<tr>
<td></td>

<td>
<center>2.8</center>
</td>

<td>
<center>1.8</center>
</td>

<td>
<center>4.4</center>
</td>
</tr>

<tr>
<td COLSPAN="4">
<hr></td>
</tr>
</table>

<p>Step 1: Express the data in terms of their ranks&nbsp;
<table CELLPADDING=2 WIDTH="50%" >
<tr ALIGN=CENTER>
<td WIDTH="20%"></td>

<td WIDTH="20%">A</td>

<td WIDTH="20%">B</td>

<td WIDTH="20%">C</td>

<td WIDTH="20%">D</td>
</tr>

<tr height="1">
<td></td>

<td COLSPAN="4">
<hr></td>
</tr>

<tr ALIGN=CENTER>
<td></td>

<td>17</td>

<td>10</td>

<td>2</td>

<td>11</td>
</tr>

<tr ALIGN=CENTER>
<td></td>

<td>19</td>

<td>4.5</td>

<td>4.5</td>

<td>9</td>
</tr>

<tr ALIGN=CENTER>
<td></td>

<td>14</td>

<td>6</td>

<td>3</td>

<td>12</td>
</tr>

<tr ALIGN=CENTER>
<td></td>

<td>15</td>

<td>13</td>

<td>7</td>

<td>16</td>
</tr>

<tr>
<td></td>

<td></td>

<td>
<center>8</center>
</td>

<td>
<center>1</center>
</td>

<td>
<center>18</center>
</td>
</tr>

<tr ALIGN=CENTER>
<td></td>

<td COLSPAN="4">
<hr></td>
</tr>

<tr ALIGN=CENTER>
<td>SUM</td>

<td>65</td>

<td>41.5</td>

<td>17.5</td>

<td>66</td>
</tr>

<tr ALIGN=CENTER>
<td></td>

<td COLSPAN="4">
<hr></td>
</tr>
</table>

</TD>
</TR>
<!-- end paragraph -->

<tr>
<td valign=top width="15%">
<I>
Compute the test statistic
</I>
</td>

<td valign=top width="85%">
The corresponding \(H\)
<!-- <i>H</i>  -->
test statistic is

$$ H = \frac{12}{19(20)} \left[ \frac{65^2}{4} + \frac{41.5^2}{5} + \frac{17.5^2}{5} + \frac{66^2}{5} \right] 
     - 3(20) = 13.678 \, . $$

<!--
<center>
<img SRC="eqns/kw4.gif" ALT=
"H = (12/(19*20))*[65**2/4 + 41.5**2/5 + 17.5**2/5 + 66**2/5] -
 3*20 = 13.678">
</center>
<p>
-->
From the <a href="../../eda/section3/eda3674.html">chi-square table</a> 
in Chapter 1, the critical value for 1 - \(\alpha\) 
<!-- 1-<i>&alpha;</i> -->
= 0.95 with <i>df</i> = \(k\) - 1 = 3
<!-- <i>k</i>-1 = 3 -->
is 7.812.  Since 13.678 > 7.812, we reject the null hypothesis.
<p>
Note that the rejection region for the KW procedure is one-sided,
since we only reject the null hypothesis when the \(H\)
<!-- <i>H</i> -->
statistic is too large.

</td>
</tr>



   

   

   

   
</TABLE>

<IMG SRC="../../gifs/nvgbrbtm.gif" BORDER=0 USEMAP="#nvbar.nvbar">
<map name="nvbar.nvbar">
<area shape="rect" href="http://www.nist.gov/" coords="22,6,67,20">
<area shape="rect" href="http://www.sematech.org/" coords="3,23,92,40">
<area shape="rect" alt="Home" href="../../index-2.html" coords="114,12,165,31">
<area shape="rect" alt="Tools & Aids" href="../../toolaids.html" coords="190,12,290,31">
<area shape="rect" alt="Search Handbook" href="../../search.html" coords="318,14,376,30">
<area shape="rect" alt="Previous Page" href="prc4.html" coords="428,15,471,29">
<area shape="rect" alt="Next Page" href="prc42.html" coords="476,15,517,30">
<area shape="default" nohref>
</map>
   
</BODY>


<!-- Mirrored from www.itl.nist.gov/div898/handbook/prc/section4/prc41.htm by HTTrack Website Copier/3.x [XR&CO'2014], Fri, 17 Feb 2017 21:49:13 GMT -->
</HTML>
